"use strict";(self.webpackChunkmjazuly=self.webpackChunkmjazuly||[]).push([[9332],{1470:(e,n,a)=>{a.d(n,{A:()=>v});var i=a(6540),t=a(4164),r=a(7559),s=a(3104),l=a(6347),c=a(205),o=a(7485),d=a(1682),u=a(679);function h(e){return i.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function g(e){const{values:n,children:a}=e;return(0,i.useMemo)((()=>{const e=n??function(e){return h(e).map((({props:{value:e,label:n,attributes:a,default:i}})=>({value:e,label:n,attributes:a,default:i})))}(a);return function(e){const n=(0,d.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,a])}function m({value:e,tabValues:n}){return n.some((n=>n.value===e))}function p({queryString:e=!1,groupId:n}){const a=(0,l.W6)(),t=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,o.aZ)(t),(0,i.useCallback)((e=>{if(!t)return;const n=new URLSearchParams(a.location.search);n.set(t,e),a.replace({...a.location,search:n.toString()})}),[t,a])]}function k(e){const{defaultValue:n,queryString:a=!1,groupId:t}=e,r=g(e),[s,l]=(0,i.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!m({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:r}))),[o,d]=p({queryString:a,groupId:t}),[h,k]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[a,t]=(0,u.Dv)(n);return[a,(0,i.useCallback)((e=>{n&&t.set(e)}),[n,t])]}({groupId:t}),x=(()=>{const e=o??h;return m({value:e,tabValues:r})?e:null})();(0,c.A)((()=>{x&&l(x)}),[x]);return{selectedValue:s,selectValue:(0,i.useCallback)((e=>{if(!m({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),k(e)}),[d,k,r]),tabValues:r}}var x=a(2303);const j={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=a(4848);function y({className:e,block:n,selectedValue:a,selectValue:i,tabValues:r}){const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.a_)(),o=e=>{const n=e.currentTarget,t=l.indexOf(n),s=r[t].value;s!==a&&(c(n),i(s))},d=e=>{let n=null;switch(e.key){case"Enter":o(e);break;case"ArrowRight":{const a=l.indexOf(e.currentTarget)+1;n=l[a]??l[0];break}case"ArrowLeft":{const a=l.indexOf(e.currentTarget)-1;n=l[a]??l[l.length-1];break}}n?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":n},e),children:r.map((({value:e,label:n,attributes:i})=>(0,f.jsx)("li",{role:"tab",tabIndex:a===e?0:-1,"aria-selected":a===e,ref:e=>{l.push(e)},onKeyDown:d,onClick:o,...i,className:(0,t.A)("tabs__item",j.tabItem,i?.className,{"tabs__item--active":a===e}),children:n??e},e)))})}function b({lazy:e,children:n,selectedValue:a}){const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=r.find((e=>e.props.value===a));return e?(0,i.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:r.map(((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==a})))})}function I(e){const n=k(e);return(0,f.jsxs)("div",{className:(0,t.A)(r.G.tabs.container,"tabs-container",j.tabList),children:[(0,f.jsx)(y,{...n,...e}),(0,f.jsx)(b,{...n,...e})]})}function v(e){const n=(0,x.A)();return(0,f.jsx)(I,{...e,children:h(e.children)},String(n))}},6489:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>s,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"wazuh/endpoint-security/wazuh-es-1","title":"File Integirty Monitoring","description":"Pelajari panduan komprehensif tentang File Integrity Monitoring (FIM) pada Wazuh, solusi keamanan digital yang krusial untuk memastikan integritas data dan kepatuhan regulasi seperti PCI DSS dan GDPR. Artikel ini mengulas cara kerja FIM, mulai dari pembuatan baseline file menggunakan hash dan metadata, hingga pemantauan real-time pada endpoint Linux dan Windows. Temukan langkah-langkah konfigurasi Wazuh FIM secara terperinci dalam file ossec.conf, termasuk pengaturan real-time monitoring, penjadwalan pemindaian (<frequency>, scan_time), dan cara aman untuk melaporkan konten yang diubah (report_changes) sambil menerapkan pengecualian (ignore), yang semuanya bertujuan untuk mendukung pertahanan keamanan siber organisasi Anda.","source":"@site/docs/wazuh/endpoint-security/file-integrity-monitoring.md","sourceDirName":"wazuh/endpoint-security","slug":"/wazuh/file-integrity-monitoring","permalink":"/docs/wazuh/file-integrity-monitoring","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Wazuh","permalink":"/docs/tags/wazuh","description":"Sebuah platform open-source yang populer untuk keamanan siber (cybersecurity), yang menggabungkan fungsi Security Information and Event Management (SIEM) dan Security Orchestration, Automation, and Response (SOAR) dengan Endpoint Detection and Response (EDR)."}],"version":"current","lastUpdatedBy":"Mochamad Jazuly","lastUpdatedAt":1755622800000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2,"id":"wazuh-es-1","slug":"/wazuh/file-integrity-monitoring","title":"File Integirty Monitoring","description":"Pelajari panduan komprehensif tentang File Integrity Monitoring (FIM) pada Wazuh, solusi keamanan digital yang krusial untuk memastikan integritas data dan kepatuhan regulasi seperti PCI DSS dan GDPR. Artikel ini mengulas cara kerja FIM, mulai dari pembuatan baseline file menggunakan hash dan metadata, hingga pemantauan real-time pada endpoint Linux dan Windows. Temukan langkah-langkah konfigurasi Wazuh FIM secara terperinci dalam file ossec.conf, termasuk pengaturan real-time monitoring, penjadwalan pemindaian (<frequency>, scan_time), dan cara aman untuk melaporkan konten yang diubah (report_changes) sambil menerapkan pengecualian (ignore), yang semuanya bertujuan untuk mendukung pertahanan keamanan siber organisasi Anda.","authors":[{"name":"mochamad jazuly"},{"title":"cybersecurity analyst"},{"url":"https://github.com/coffee-90"},{"socials":[{"x":"mjazuly_id"},{"github":"coffee-90"},{"instagram":"mjazuly.id"},{"threads":"mjazuly.id"},{"linkedin":"mjazuly"}]}],"keywords":["Wazuh FIM","File Integrity Monitoring","konfigurasi Wazuh FIM","cara kerja FIM","monitoring integritas file","deteksi perubahan file","Wazuh agent","ossec.conf","Wazuh server","pemantauan real-time","syscheck Wazuh","keamanan digital","keamanan siber","deteksi aktivitas mencurigakan","pelanggaran keamanan data","kepatuhan regulasi","PCI DSS","HIPAA","GDPR","baseline FIM","hash kriptografi","SHA-1","MD5","metadata file","inotify","kernel Linux","layanan auditing Windows","analisis Wazuh","alert FIM","dashboard Wazuh","direktori yang dimonitor","FILEPATH_OF_MONITORED_DIRECTORY","/etc/passwd FIM","/var/www/html FIM","real-time monitoring Wazuh","Record File Attributes","check_all","check_mtime","Scheduled scans Wazuh","<frequency>900</frequency>","scan_time","scan_day","Report changes FIM","report_changes=\\"yes\\"","nodiff","adding exclusion FIM","ignore","Best Practice FIM Agent","PoC FIM","sistem keamanan digital","minimalisir manipulasi data","log aktivitas pemantauan","konfigurasi terpusat Wazuh"],"tags":["wazuh"],"last_update":{"date":"8/20/2025","author":"Mochamad Jazuly"},"draft":false},"sidebar":"tutorialSidebar","previous":{"title":"Endpoint Security","permalink":"/docs/category/endpoint-security"}}');var t=a(4848),r=a(8453);a(1470),a(9365);const s={sidebar_position:2,id:"wazuh-es-1",slug:"/wazuh/file-integrity-monitoring",title:"File Integirty Monitoring",description:"Pelajari panduan komprehensif tentang File Integrity Monitoring (FIM) pada Wazuh, solusi keamanan digital yang krusial untuk memastikan integritas data dan kepatuhan regulasi seperti PCI DSS dan GDPR. Artikel ini mengulas cara kerja FIM, mulai dari pembuatan baseline file menggunakan hash dan metadata, hingga pemantauan real-time pada endpoint Linux dan Windows. Temukan langkah-langkah konfigurasi Wazuh FIM secara terperinci dalam file ossec.conf, termasuk pengaturan real-time monitoring, penjadwalan pemindaian (<frequency>, scan_time), dan cara aman untuk melaporkan konten yang diubah (report_changes) sambil menerapkan pengecualian (ignore), yang semuanya bertujuan untuk mendukung pertahanan keamanan siber organisasi Anda.",authors:[{name:"mochamad jazuly"},{title:"cybersecurity analyst"},{url:"https://github.com/coffee-90"},{socials:[{x:"mjazuly_id"},{github:"coffee-90"},{instagram:"mjazuly.id"},{threads:"mjazuly.id"},{linkedin:"mjazuly"}]}],keywords:["Wazuh FIM","File Integrity Monitoring","konfigurasi Wazuh FIM","cara kerja FIM","monitoring integritas file","deteksi perubahan file","Wazuh agent","ossec.conf","Wazuh server","pemantauan real-time","syscheck Wazuh","keamanan digital","keamanan siber","deteksi aktivitas mencurigakan","pelanggaran keamanan data","kepatuhan regulasi","PCI DSS","HIPAA","GDPR","baseline FIM","hash kriptografi","SHA-1","MD5","metadata file","inotify","kernel Linux","layanan auditing Windows","analisis Wazuh","alert FIM","dashboard Wazuh","direktori yang dimonitor","FILEPATH_OF_MONITORED_DIRECTORY","/etc/passwd FIM","/var/www/html FIM","real-time monitoring Wazuh","Record File Attributes","check_all","check_mtime","Scheduled scans Wazuh","<frequency>900</frequency>","scan_time","scan_day","Report changes FIM",'report_changes="yes"',"nodiff","adding exclusion FIM","ignore","Best Practice FIM Agent","PoC FIM","sistem keamanan digital","minimalisir manipulasi data","log aktivitas pemantauan","konfigurasi terpusat Wazuh"],tags:["wazuh"],last_update:{date:"8/20/2025",author:"Mochamad Jazuly"},draft:!1},l="File Integirty Monitoring",c={},o=[{value:"Pengaturan FIM",id:"pengaturan-fim",level:2},{value:"Pengaturan Dasar FIM",id:"pengaturan-dasar-fim",level:2},{value:"Real-time Monitoring",id:"real-time-monitoring",level:3},{value:"Record File Attributes",id:"record-file-attributes",level:3},{value:"Scheduled scans",id:"scheduled-scans",level:3},{value:"Report changes",id:"report-changes",level:3},{value:"Report changes - nodiff",id:"report-changes---nodiff",level:4},{value:"Adding exclusion",id:"adding-exclusion",level:4},{value:"Best Practice FIM Agent",id:"best-practice-fim-agent",level:2},{value:"PoC FIM",id:"poc-fim",level:3}];function d(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"file-integirty-monitoring",children:"File Integirty Monitoring"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"File Integrity Monitoring (FIM)"})," pada Wazuh bisa diibaratkan sebagai sistem keamanan digital yang terus mengawasi file-file penting dalam organisasi Anda. Setiap kali ada file yang diubah, dihapus, atau ditambahkan di lokasi yang sudah ditentukan, Wazuh akan langsung mendeteksi, mencatat, dan mengirimkan peringatan kepada administrator sistem."]}),"\n",(0,t.jsx)(n.p,{children:"FIM ini sangat krusial untuk:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Mendeteksi aktivitas yang tidak sah atau mencurigakan secara cepat."}),"\n",(0,t.jsx)(n.li,{children:"Mengidentifikasi potensi pelanggaran keamanan data."}),"\n",(0,t.jsx)(n.li,{children:"Memastikan organisasi tetap patuh pada regulasi seperti PCI DSS, HIPAA, atau GDPR yang memang mewajibkan pemantauan integritas file."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Bagaimana cara kerjanya? Berikut penjelasan singkatnya:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Pembuatan Baseline"}),(0,t.jsx)(n.br,{}),"\n","Ketika FIM diaktifkan pada direktori tertentu, Wazuh melakukan pemindaian awal dan mencatat kondisi dasar semua file. Informasi yang disimpan termasuk hash kriptografi (seperti SHA-1 atau MD5), serta metadata file seperti izin akses, kepemilikan, dan ukuran."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Pemantauan Real-time"}),(0,t.jsx)(n.br,{}),"\n","Wazuh memanfaatkan sistem audit pada kernel Linux (inotify) atau layanan auditing pada Windows untuk memantau perubahan file secara real-time, sehingga proses pemantauan jauh lebih efisien."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Deteksi Perubahan"}),(0,t.jsx)(n.br,{}),"\n","Setiap ada perubahan pada file, agen Wazuh langsung:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Menghitung hash terbaru,"}),"\n",(0,t.jsx)(n.li,{children:"Mengumpulkan metadata terbaru,"}),"\n",(0,t.jsx)(n.li,{children:"Mengirimkan informasi tersebut ke server Wazuh."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Analisis dan Peringatan"}),(0,t.jsx)(n.br,{}),"\n","Server Wazuh akan membandingkan data terbaru dengan baseline yang sudah ada. Bila ditemukan perbedaan, sistem secara otomatis mengirimkan alert dan menampilkannya di dashboard web UI."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Dengan implementasi FIM pada Wazuh, organisasi dapat memastikan bahwa integritas data tetap terjaga, risiko kebocoran atau manipulasi data bisa diminimalisir, serta kepatuhan terhadap standar regulasi tetap terjaga."}),"\n",(0,t.jsx)(n.h2,{id:"pengaturan-fim",children:"Pengaturan FIM"}),"\n",(0,t.jsx)(n.p,{children:"FIM dapat dikonfigurasi terpusat pada Wazuh Server maupun secara individual pada Wazuh Agent."}),"\n",(0,t.jsxs)(n.p,{children:["Pengaturan FIM dilakukan pada file konfigurasi ",(0,t.jsx)(n.code,{children:"ossec.conf"}),","]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Linux: ",(0,t.jsx)(n.code,{children:"/var/ossec/etc/ossec.conf"})]}),"\n",(0,t.jsxs)(n.li,{children:["Windows: ",(0,t.jsx)(n.code,{children:"C:\\Program Files (x86)\\ossec-agent\\ossec.conf"})]}),"\n",(0,t.jsxs)(n.li,{children:["macOS: ",(0,t.jsx)(n.code,{children:"/Library/Ossec/etc/ossec.conf"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Standar konfigurasi FIM sebagai berikut:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"<syscheck>\r\n   <directories><FILEPATH_OF_MONITORED_FILE></directories>\r\n   <directories><FILEPATH_OF_MONITORED_DIRECTORY></directories>\r\n</syscheck>\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"FILEPATH_OF_MONITORED_FILE"})," : lokasi file (spesifik) yang dimonitor.","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["contoh :","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"/etc/passwd"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"C:\\Windows\\System32\\drivers\\etc\\hosts"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"FILEPATH_OF_MONITORED_DIRECTORY"})," : lokasi direktori/ folder yang dimonitor.","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["contoh :","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"/var/www/html/"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"/home/user/"})}),"\n",(0,t.jsxs)(n.li,{children:["*",(0,t.jsx)(n.em,{children:"*"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsx)(n.p,{children:"Rekomendasi direktori dan file untuk dimonitor"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.sysdig.com/blog/file-integrity-monitoring#1-prepare-an-asset-inventory",children:"Linux : Top 9 file integrity monitoring (FIM) best practices"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/defender-for-cloud/file-integrity-monitoring-overview#choose-what-to-monitor",children:"Linux file, Windows file, Windows registry keys (HKEY_LOCAL_MACHINE)"})}),"\n"]})]}),"\n",(0,t.jsx)(n.h2,{id:"pengaturan-dasar-fim",children:"Pengaturan Dasar FIM"}),"\n",(0,t.jsx)(n.h3,{id:"real-time-monitoring",children:"Real-time Monitoring"}),"\n",(0,t.jsx)(n.p,{children:"Real-time memungkinkan pemantauan secara real-time/ berkelanjutan terhadap direktori pada endpoint Windows dan Linux saja."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-config",metastring:'title="/var/ossec/etc/ossec.conf"',children:'<syscheck>\r\n   <directories realtime="yes"><FILEPATH_OF_MONITORED_DIRECTORY></directories>\r\n</syscheck>\n'})}),"\n",(0,t.jsx)(n.h3,{id:"record-file-attributes",children:"Record File Attributes"}),"\n",(0,t.jsx)(n.p,{children:"Ketika melakukan konfigurasi modul FIM untuk memantau file dan direktori tertentu, modul ini akan mencatat metadata file dan memantaunya. Kita dapat menggunakan opsi direktori untuk menetapkan metadata file tertentu yang harus dikumpulkan dan diabaikan oleh modul FIM. Opsi direktori mendukung beberapa atribut."}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{style:{textAlign:"center"},children:"Attribute"}),(0,t.jsx)(n.th,{style:{textAlign:"center"},children:"Default values"}),(0,t.jsx)(n.th,{style:{textAlign:"center"},children:"Allowed values"}),(0,t.jsx)(n.th,{style:{textAlign:"center"},children:"Description"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"center"},children:(0,t.jsx)(n.code,{children:"check_all"})}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"yes"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"yes, no"}),(0,t.jsxs)(n.td,{style:{textAlign:"center"},children:["Records the value of all attributes: ",(0,t.jsx)(n.code,{children:"check_sum"}),", ",(0,t.jsx)(n.code,{children:"check_sha1sum"}),", ",(0,t.jsx)(n.code,{children:"check_md5sum"}),", ",(0,t.jsx)(n.code,{children:"check_sha256sum"}),", ",(0,t.jsx)(n.code,{children:"check_size"}),", ",(0,t.jsx)(n.code,{children:"check_owner"}),", ",(0,t.jsx)(n.code,{children:"check_group"}),", ",(0,t.jsx)(n.code,{children:"check_perm"}),", ",(0,t.jsx)(n.code,{children:"check_attrs"}),", ",(0,t.jsx)(n.code,{children:"check_mtime"}),", ",(0,t.jsx)(n.code,{children:"check_inode"})]})]})})]}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsxs)(n.p,{children:["Jika terjadi konflik antara opsi yang memodifikasi atribut yang sama, ",(0,t.jsx)(n.strong,{children:"opsi yang terakhir dikonfigurasi akan diutamakan"}),"."]}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'<directories check_all="no" check_mtime="yes">/etc</directories>'})," : tidak merekam perubahan semua atribut, kecuali waktu modifikasi."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'<directories check_mtime="yes" check_all="no">/etc</directories>'})," : tidak merekam perubahan semua atribut, termasuk waktu modifikasi."]}),"\n"]})]}),"\n",(0,t.jsx)(n.p,{children:"Contoh :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-config",metastring:'title="/var/ossec/etc/ossec.conf"',children:'<syscheck>\r\n   <directories check_sha1sum="no"><FILEPATH_OF_MONITORED_FILE></directories>\r\n</syscheck>\n'})}),"\n",(0,t.jsx)(n.h3,{id:"scheduled-scans",children:"Scheduled scans"}),"\n",(0,t.jsxs)(n.p,{children:["Untuk mengubah jadwal pemindaian modul FIM, kita dapat mengonfigurasi opsi ",(0,t.jsx)(n.code,{children:"<frequency>"})," pada modul FIM Wazuh."]}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsx)(n.p,{children:"Modul FIM menjalankan pemindaian setiap 12 jam (43200 detik) secara default."})}),"\n",(0,t.jsxs)(n.admonition,{title:"Contoh Konfigurasi 1",type:"tip",children:[(0,t.jsx)(n.p,{children:"Mengubah jadwal pemindaian setiap 900 detik (15 menit)."}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-config",metastring:'title="/var/ossec/etc/ossec.conf"',children:"<syscheck>\r\n  <frequency>900</frequency>\r\n</syscheck>\n"})})]}),"\n",(0,t.jsxs)(n.p,{children:["Sebagai alternatif, kita dapat menjadwalkan pemindaian menggunakan opsi ",(0,t.jsx)(n.code,{children:"scan_time"})," dan ",(0,t.jsx)(n.code,{children:"scan_day"}),". Konfigurasi FIM menggunakan opsi-opsi ini membantu mengatur pemindaian FIM di luar jam kerja."]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{style:{textAlign:"center"},children:"Attribute"}),(0,t.jsx)(n.th,{style:{textAlign:"center"},children:"Default values"}),(0,t.jsx)(n.th,{style:{textAlign:"center"},children:"Allowed values"}),(0,t.jsx)(n.th,{style:{textAlign:"center"},children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"scan_day"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"n/a"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"Day of the week."}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"Day of the week to run the scans, one entry per line. ex: thrusday"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"scan_time"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"n/a"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"Time of day."}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"Time to runs the scans. ex: 9pm or 8:30"})]})]})]}),"\n",(0,t.jsxs)(n.admonition,{title:"Contoh Konfigurasi 2",type:"tip",children:[(0,t.jsx)(n.p,{children:"Mengubah jadwal pemindaian setiap jam 10 malam di hari Sabtu."}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-config",metastring:'title="/var/ossec/etc/ossec.conf"',children:"<syscheck>\r\n   <scan_time>10pm</scan_time>\r\n   <scan_day>saturday</scan_day>\r\n</syscheck>\n"})})]}),"\n",(0,t.jsx)(n.h3,{id:"report-changes",children:"Report changes"}),"\n",(0,t.jsxs)(n.p,{children:["Atribut ",(0,t.jsx)(n.code,{children:"report_changes"})," memungkinkan modul FIM untuk melaporkan konten yang diubah. fitur ini mencatat teks yang ditambahkan atau dihapus dari berkas yang dipantau. Kita dapat mengkonfigurasi fungsi ini dengan mengaktifkan atribut ",(0,t.jsx)(n.code,{children:"report_changes"})," pada opsi ",(0,t.jsx)(n.code,{children:"directories"}),". Nilai yang diizinkan untuk atribut ini adalah ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"yes"})})," dan ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"no"})}),". Fitur ini berfungsi baik pada direktori maupun berkas individu di endpoint Windows, macOS, dan Linux."]}),"\n",(0,t.jsxs)(n.admonition,{type:"warning",children:[(0,t.jsxs)(n.p,{children:["Kita harus menggunakan atribut ",(0,t.jsx)(n.code,{children:"report_changes"})," dengan hati-hati saat mengaktifkan opsi ini. Wazuh menyalin setiap berkas yang dipantau ke ",(0,t.jsx)(n.em,{children:"private location"}),", yang ",(0,t.jsx)(n.strong,{children:"dapat meningkatkan penggunaan penyimpanan"}),"."]}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.em,{children:"Private location"})," :"]}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Linus : ",(0,t.jsx)(n.code,{children:"/var/ossec/queue/diff/local/"})]}),"\n",(0,t.jsxs)(n.li,{children:["macOS : ",(0,t.jsx)(n.code,{children:"Library/Ossec/queue/diff/local/"})]}),"\n",(0,t.jsxs)(n.li,{children:["Windows : ",(0,t.jsx)(n.code,{children:"C:\\Program Files (x86)\\ossec-agent\\queue\\diff\\local\\"})]}),"\n"]})]}),"\n",(0,t.jsxs)(n.admonition,{title:"Contoh Konfigurasi",type:"tip",children:[(0,t.jsxs)(n.p,{children:["Cek menggunakan semua konfigurasi FIM dan laporkan konten yang berubah pada direktori ",(0,t.jsx)(n.code,{children:"/var/www/html/"})]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-config",metastring:'title="/var/ossec/etc/ossec.conf"',children:'<syscheck>\r\n   <directories check_all="yes" report_changes="yes">/var/www/html</directories>\r\n</syscheck>\n'})})]}),"\n",(0,t.jsx)(n.h4,{id:"report-changes---nodiff",children:"Report changes - nodiff"}),"\n",(0,t.jsxs)(n.p,{children:["Daftar file yang tidak perlu dihitung perbedaannya (satu entri per baris). Daftar ini dapat digunakan untuk file sensitif seperti ",(0,t.jsx)(n.em,{children:"private key"}),", kredensial yang disimpan dalam file, atau konfigurasi database, untuk menghindari kebocoran data dengan mengirimkan perubahan konten file melalui ",(0,t.jsx)(n.em,{children:"alert"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-config",metastring:'title="/var/ossec/etc/ossec.conf"',children:'<syscheck>\r\n   <directories check_all="yes" report_changes="yes"><FILEPATH_OF_MONITORED_DIRECTORY></directories>\r\n   // highlight-start\r\n   <nodiff><FILEPATH_OF_MONITORED_DIRECTORY>/private.txt</nodiff>\r\n   // highlight-end\r\n</syscheck>\n'})}),"\n",(0,t.jsxs)(n.admonition,{title:"Contoh Konfigurasi - nodiff",type:"tip",children:[(0,t.jsxs)(n.p,{children:["Cek menggunakan semua konfigurasi FIM dan laporkan konten yang berubah pada direktori ",(0,t.jsx)(n.code,{children:"/var/www/html/"}),", kecuali file ",(0,t.jsx)(n.code,{children:"wp-config.php"}),"."]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-config",metastring:'title="/var/ossec/etc/ossec.conf"',children:'<syscheck>\r\n   <directories check_all="yes" report_changes="yes">/var/www/html/</directories>\r\n   <nodiff>/var/www/html/wp-config.php</nodiff>\r\n</syscheck>\n'})})]}),"\n",(0,t.jsx)(n.h4,{id:"adding-exclusion",children:"Adding exclusion"}),"\n",(0,t.jsxs)(n.p,{children:["Kita dapat menggunakan opsi ",(0,t.jsx)(n.code,{children:"ignore"})," untuk mengabaikan suatu path untuk dimonitor."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-config",metastring:'title="/var/ossec/etc/ossec.conf"',children:'<syscheck>\r\n   <ignore><FILEPATH_OF_MONITORED_FILE></ignore>\r\n   <ignore type="sregex">.log$|.tmp$</ignore>\r\n</syscheck>\n'})}),"\n",(0,t.jsxs)(n.admonition,{title:"Contoh Konfigurasi - ignore",type:"tip",children:[(0,t.jsxs)(n.p,{children:["Cek menggunakan semua konfigurasi FIM dan laporkan konten yang berubah pada direktori ",(0,t.jsx)(n.code,{children:"/var/www/html/"}),", kecuali file ",(0,t.jsx)(n.code,{children:"wp-config.php"}),"."]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-config",metastring:'title="/var/ossec/etc/ossec.conf"',children:'<syscheck>\r\n   <ignore>/path/to/your/laravel/storage/logs/*</ignore>\r\n   <ignore>/path/to/your/laravel/bootstrap/cache/*</ignore>\r\n   <ignore>/path/to/your/laravel/vendor/*</ignore>\r\n   <ignore>/path/to/your/laravel/.env</ignore>\r\n   <ignore>/path/to/your/laravel/public/mix-manifest.json</ignore>\r\n   \x3c!-- Add more ignore paths as needed for your specific Laravel setup --\x3e\r\n\r\n   <ignore type="sregex">.json$</ignore>\r\n</syscheck>\n'})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"best-practice-fim-agent",children:"Best Practice FIM Agent"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)("h2",{children:"Wazuh agent : Linux"})})}),"\n"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Ubah pengaturan pada ",(0,t.jsx)(n.code,{children:"ossec.conf"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"$ sudo su\r\n# nano /var/ossec/etc/ossec.conf\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Tambahkan kode berikut (",(0,t.jsx)(n.em,{children:"highlighted"}),")"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-config",metastring:'title="/var/ossec/etc/ossec.conf"',children:'   \x3c!-- File integrity monitoring --\x3e\r\n   <syscheck>\r\n   \x3c!-- Directories to check  (perform all possible verifications) --\x3e\r\n// highlight-start\r\n      <directories check_all="yes" report_changes="yes" realtime="yes">/home</directories>\r\n      <directories check_all="yes" report_changes="yes" realtime="yes">/var/www/html</directories>\r\n      <directories check_all="yes" report_changes="yes" realtime="yes">/etc/passwd</directories>\r\n// highlight-end\r\n   </syscheck>\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Restart wazuh agent"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"systemctl restart wazuh-agent\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"poc-fim",children:"PoC FIM"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)("h2",{children:"Wazuh agent"})})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"$ cd /home/kaito\r\n$ touch exploit.c\r\n$ echo \u201chello\u201d >> exploit.c\r\n$ cp exploit.c exploit2.c\r\n$ rm exploit.c\n"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)("h2",{children:"Wazuh Dashboard | FIM"})})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://cdn-images-1.medium.com/max/2560/1*xJgdZrVgBWqUfuylFjxdQg.png",alt:"Proof of Concept (PoC) File Integrity Monitoring Wazuh"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.p,{children:"Sumber :"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://documentation.wazuh.com/current/user-manual/capabilities/file-integrity/index.html",children:"Wazuh Documentation - File Integrity"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.sysdig.com/blog/file-integrity-monitoring",children:"Top 9 file integrity monitoring (FIM) best practices"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/defender-for-cloud/file-integrity-monitoring-overview#choose-what-to-monitor",children:"Microsoft Ignite - File integrity monitoring"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://documentation.wazuh.com/current/user-manual/reference/ossec-conf/syscheck.html",children:"Wazuh Documentation - syscheck"})}),"\n"]}),"\n",(0,t.jsx)("center",{children:(0,t.jsx)(n.em,{children:"Jika informasi ini bermanfaat bagi Anda"})}),"\n",(0,t.jsxs)("center",{children:[(0,t.jsx)(n.em,{children:"saya sangat mengapresiasi jika ditraktir kopi"})," \u2615"]}),"\n",(0,t.jsx)("center",{children:"\ud83d\udd3b"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://saweria.co/mjazuly",children:(0,t.jsx)(n.img,{src:"https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png#bmc",alt:"buy me a coffee"})})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>s,x:()=>l});var i=a(6540);const t={},r=i.createContext(t);function s(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),i.createElement(r.Provider,{value:n},e.children)}},9365:(e,n,a)=>{a.d(n,{A:()=>s});a(6540);var i=a(4164);const t={tabItem:"tabItem_Ymn6"};var r=a(4848);function s({children:e,hidden:n,className:a}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,i.A)(t.tabItem,a),hidden:n,children:e})}}}]);